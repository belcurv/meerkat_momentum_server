$(document).ready(function(){BG.init(),Panels.init(),Settings.init(),Quotes.init(),Time.init(),Focus.init(),Todos.init(),Weather.init(),setInterval(Time.init,2e4)});var BG=function(){"use strict";function t(){var t="https://unsplash.it/1920/1080/?random";$.when(e(t)).done(a)}function e(t){return $.Deferred(function(e){var a=new Image;a.onload=function(){e.resolve(a)},a.onerror=function(){e.reject()},a.src=t}).promise()}function a(t){$(".splash").append(t).css("opacity",1)}return{init:t}}(),Focus=function(){function t(){r.$focusInput=$("#focus-input"),r.$focusCheckbox=$("#focus-chkbx"),r.$focusClose=$("#focus-close"),r.$focusList=$(".focus-list"),r.$focusListMsg=$(".focus-list-message")}function e(){$("form").submit(function(){return!1}),r.$focusInput.on("keyup",a),r.$focusCheckbox.on("click",o),r.$focusClose.on("click",n)}function a(t){var e,a=$(t.target),n=a.val().trim();13===t.which&&n&&(e={val:n,isChecked:!1},LS.setData("focus-storage",e),a.val(""),s())}function n(t){var e=(LS.getData("focus-storage"),{val:null,isChecked:!1});LS.setData("focus-storage",e),s()}function o(t){var e=LS.getData("focus-storage"),a={val:e.val,isChecked:!e.isChecked};LS.setData("focus-storage",a),s()}function s(){var t=LS.getData("focus-storage");return t&&t.val?(r.$focusInput.css("display","none"),r.$focusList.css("display","block"),r.$focusListMsg.html(t.val),void(t.isChecked?(r.$focusListMsg.addClass("finished"),r.$focusCheckbox.html('<i class="fa fa-check-square-o" aria-hidden="true"></i>'),r.$focusClose.html('<i class="fa fa-plus" aria-hidden="true"></i>')):(r.$focusListMsg.removeClass("finished"),r.$focusCheckbox.html('<i class="fa fa-square-o" aria-hidden="true"></i>'),r.$focusClose.html('<i class="fa fa-times" aria-hidden="true"></i>')))):(r.$focusInput.css("display","block"),void r.$focusList.css("display","none"))}function i(){t(),e()}var r={};return{init:i}}(),LS=function(){function t(t,e){o&&o.setItem(t,JSON.stringify(e))}function e(t){if(o)return JSON.parse(o.getItem(t))}function a(){if(o)return o.clear()}function n(t){if(o)return o.removeItem(t)}var o=function(){var t,e,a=(new Date).toString();try{return t=window.localStorage,t.setItem(a,a),e=t.getItem(a)===a,t.removeItem(a),e&&t}catch(t){}}();return{setData:t,getData:e,deleteData:n,clearData:a}}(),Panels=function(){"use strict";function t(){c.$meerkatBtn=$("#meerkat-btn"),c.$aboutPanel=$("#about-panel"),c.$todosBtn=$("#todos-btn"),c.$todosPanel=$("#todos-panel"),c.$settingsBtn=$("#settings-btn"),c.$settingsPanel=$("#settings-panel"),c.$weatherBtn=$("#weather-feature"),c.$weatherPanel=$("#weather-panel"),c.$overlay=$('<div id="overlay"></div>')}function e(){c.$overlay.on("click",a),c.$meerkatBtn.on("click",n),c.$todosBtn.on("click",o),c.$settingsBtn.on("click",s),c.$weatherBtn.on("click",i)}function a(t){t.preventDefault(),c.$overlay.hide(),c.$aboutPanel.removeClass("left-panel-show"),c.$todosPanel.removeClass("right-panel-show"),c.$settingsPanel.removeClass("left-panel-show"),c.$weatherPanel.removeClass("right-panel-show"),t.stopPropagation()}function n(t){c.$aboutPanel.toggleClass("left-panel-show"),c.$overlay.show(),c.$todosPanel.removeClass("right-panel-show"),c.$settingsPanel.removeClass("left-panel-show"),c.$weatherPanel.removeClass("right-panel-show"),t.stopPropagation()}function o(t){c.$todosPanel.toggleClass("right-panel-show"),c.$overlay.toggle(),c.$aboutPanel.removeClass("left-panel-show"),c.$settingsPanel.removeClass("left-panel-show"),c.$weatherPanel.removeClass("right-panel-show"),t.stopPropagation()}function s(t){c.$settingsPanel.toggleClass("left-panel-show"),c.$overlay.toggle(),c.$aboutPanel.removeClass("left-panel-show"),c.$todosPanel.removeClass("right-panel-show"),c.$weatherPanel.removeClass("right-panel-show"),t.stopPropagation()}function i(t){c.$weatherPanel.toggleClass("right-panel-show"),c.$overlay.toggle(),c.$aboutPanel.removeClass("left-panel-show"),c.$settingsPanel.removeClass("left-panel-show"),c.$todosPanel.removeClass("right-panel-show"),t.stopPropagation()}function r(){t(),c.$overlay.hide(),$("body").append(c.$overlay),e()}var c={};return{init:r}}(),Quotes=function(){function t(){i.$quoteFeature=$("#quoteFeature")}function e(){var t={endpoint:"https://quotesondesign.com/wp-json/posts",params:{"filter[orderby]":"rand","filter[posts_per_page]":1,processdate:(new Date).getTime()}};$.getJSON(t.endpoint,t.params).then(n).catch(o)}function a(t){var e=/(<([^>]+)>)|(&lt;([^>]+)&gt;)/gi,a=$("<textarea></textarea>");return a.html(t),a.val().replace(e,"")}function n(t){var e=a(t[0].content);i.$quoteFeature.attr("href",t[0].link).attr("target","_blank").html(e)}function o(t){console.warn(t)}function s(){t(),e()}var i={};return{init:s}}(),Settings=function(){function t(){r.$settingsPanel=$("#settings-panel"),r.$userName=r.$settingsPanel.find("#name-input"),r.$clockFormat=r.$settingsPanel.find("#12-hr-clock-chkbx"),r.$showWeather=r.$settingsPanel.find("#show-weather-chkbx"),r.$showTodos=r.$settingsPanel.find("#show-todo-chkbx"),r.$saveSettings=r.$settingsPanel.find("#save-settings-btn"),r.$clearSettings=r.$settingsPanel.find("#clear-settings-btn")}function e(){r.$saveSettings.on("click",n),r.$clearSettings.on("click",o)}function a(){return LS.getData("momentum-settings")?{userName:LS.getData("momentum-settings").userName,clockFormat:LS.getData("momentum-settings").clockFormat,showWeather:LS.getData("momentum-settings").showWeather,showTodos:LS.getData("momentum-settings").showTodos}:{userName:void 0,clockFormat:!0,showWeather:!0,showTodos:!0}}function n(t){t.preventDefault(),c={userName:r.$userName[0].value||void 0,clockFormat:r.$clockFormat[0].checked,showWeather:r.$showWeather[0].checked,showTodos:r.$showTodos[0].checked},LS.setData("momentum-settings",c),s(),t.stopPropagation()}function o(t){t.preventDefault(),LS.deleteData("momentum-settings"),r.$userName[0].value="",r.$clockFormat[0].checked=!0,r.$showWeather[0].checked=!0,r.$showTodos[0].checked=!0,s(),t.stopPropagation()}function s(){c.userName&&(r.$userName[0].value=c.userName),r.$clockFormat[0].checked=c.clockFormat,r.$showWeather[0].checked=c.showWeather,r.$showTodos[0].checked=c.showTodos,Time.init(),a(),c.showTodos?$("#todos-btn").css("display","block"):$("#todos-btn").css("display","none"),c.showWeather?$("#weather-feature").css("display","block"):$("#weather-feature").css("display","none"),$("#settings-panel").removeClass("left-panel-show"),$("#overlay").hide()}function i(){t(),e(),s()}var r={},c=a();return{init:i}}(),Time=function(){function t(){var t=Math.floor(Math.random()*f.length);return f[t]}function e(){var t,e,a=o(n());return e=LS.getData("momentum-settings")?LS.getData("momentum-settings").userName:p,t=a<12?"morning":a>=12&&a<17?"afternoon":"evening","Good "+t+", "+e+"."}function a(){var t=LS.getData("momentum-settings");return!t||t.clockFormat}function n(){h=new Date}function o(){return h.getHours()}function s(){return h.getMinutes()}function i(){var t,e;return t=a()?o()>=13&&o()<24?o()%12:0===o()?12:o():o(),e=("0"+s()).slice(-2),t+":"+e}function r(){return o()>12?"PM":"AM"}function c(){$("#time").text(i())}function l(){$("#time-period").text(r())}function u(){$("#time-message").text(e())}function d(){n(),c(),a()&&l(),u()}var h,f=["pal","sexy","handsome","smarty pants","good looking","classy","human shield","meat bag"],p=t();return{init:d}}(),Todos=function(){function t(){r.$todosPanel=$("#todos-panel"),r.$todosInput=r.$todosPanel.find("#todos-input"),r.todosList=r.$todosPanel.find("#todos-list")}function e(){$("form").submit(function(){return!1}),r.$todosInput.on("keyup",a),$(document).on("click",".delete-task",o),$(document).on("click",".check-task",s)}function a(t){var e,a,n,o=r.$todosInput.val().trim();13===t.which&&o&&(e=LS.getData("todo-list")?LS.getData("todo-list"):[],a="object"==typeof e[0]?e[0].id+1:0,n={id:a,task:o,isChecked:!1},e.unshift(n),LS.setData("todo-list",e),r.$todosInput.val(""),r.todosList.prepend('<li id="'+n.id+'"><span class="check-task"><i class="fa fa-square-o" aria-hidden="true"></i></span>'+n.task+'<span class="delete-task"><i class="fa fa-times" aria-hidden="true"></i></span></li>'))}function n(){var t=LS.getData("todo-list");t&&t.forEach(function(t){var e='<li class="finished" id=\''+t.id+'\'><span class="check-task"><i class="fa fa-check-square-o" aria-hidden="true"></i></span>'+t.task+'<span class="delete-task"><i class="fa fa-times" aria-hidden="true"></i></span></li>',a="<li id='"+t.id+'\'><span class="check-task"><i class="fa fa-square-o" aria-hidden="true"></i></span>'+t.task+'<span class="delete-task"><i class="fa fa-times" aria-hidden="true"></i></span></li>';t.isChecked?r.todosList.append(e):r.todosList.append(a)})}function o(t){var e=LS.getData("todo-list"),a=$(t.target).parent().parent(),n=a.attr("id"),o=e.findIndex(function(t){return t.id==n});e.splice(o,1),a.remove(),LS.setData("todo-list",e)}function s(t){var e=LS.getData("todo-list"),a=$(t.target),n=a.parent().parent(),o=n.attr("id"),s=e.findIndex(function(t){return t.id==o});e[s].isChecked=!e[s].isChecked,e[s].isChecked?(a.removeClass("fa-square-o").addClass("fa-check-square-o"),n.addClass("finished")):(a.removeClass("fa-check-square-o").addClass("fa-square-o"),n.removeClass("finished")),LS.setData("todo-list",e)}function i(){t(),e(),n()}var r={};return{init:i}}(),Weather=function(){"use strict";function t(){var t={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5};"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e,a,t):a()}function e(t){console.log("Using html5 geolocation..."),n({latitude:t.coords.latitude,longitude:t.coords.longitude})}function a(){console.log("html5 geolocation failed, using IP-based location instead..."),$.getJSON("https://freegeoip.net/json/184.58.233.92").then(n).catch(r)}function n(t){var e={proxy:"https://cors-anywhere.herokuapp.com/",endpoint:"https://api.darksky.net/forecast/",key:"3530553cce7adca5c5525b813494ada0/",lat:t.latitude,lon:t.longitude};$.getJSON(e.proxy+e.endpoint+e.key+e.lat+","+e.lon).then(function(e){return o({position:t,weather:e})}).then(function(t){console.log(t),s(t),i(t)}).catch(r)}function o(t){if(t.position.city)return{position:t.position,weather:t.weather};var e={endpoint:"https://nominatim.openstreetmap.org/reverse",params:{format:"json",lat:t.position.latitude,lon:t.position.longitude,addressdetails:1}};return $.getJSON(e.endpoint,e.params).then(function(e){return{position:e.address,weather:t.weather}})}function s(t){var e=t.weather.currently.icon,a=Math.round(t.weather.currently.temperature),n=t.position.city.toUpperCase(),o=$('<div id="icon_img"></div>'),s='<p class="temp">'+a+" &degF</p>",i='<p class="location">'+n+"</p>";o.append('<i class="wi wi-forecast-io-'+e+'"></i>'),$("#weather-feature").append(o).append(s).append(i)}function i(t){var e=t.weather.daily.summary,a=t.weather.daily.data,n=$("#weather-panel .panel-content"),o=$("<p>Summary: "+e+"</p>"),s=$("<table></table>");$("<pre>"+JSON.stringify(a,null,2)+"</pre>");s.append(["<thead>","<tr>",'<th class="left">Day</th>',"<th>Low</th>","<th>High</th>","<th>Weather</th>","</tr","</thead>","<tbody>"].join("")),a.forEach(function(t){var e=new Date(1e3*t.time).toDateString(),a=$("<tr></tr>"),n=$("<tr></tr>");a.append('<td class="left">'+e.slice(0,10)+"</td>").append("<td>"+Math.round(t.temperatureMin)+"</td>").append("<td>"+Math.round(t.temperatureMax)+"</td>").append('<td><i class="wi wi-forecast-io-'+t.icon+'"></i></td>'),n.append('<td class="left" colspan="4">'+t.summary+"</td>"),s.append(a).append(n)}),n.append(o).append(s)}function r(){console.warn("Error fetching weather")}function c(){t()}return{init:c}}();